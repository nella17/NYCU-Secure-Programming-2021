from pwn import *
from Crypto.Util.number import *

HOST, PORT =  'edu-ctf.csie.org', 42071

if args.REMOTE:
    io = remote(HOST, PORT)
else:
    io = process(['python3', 'server.py'])

read = lambda: int(io.readline().split()[-1])

n = read()
c = read()
e = 65537

i = 0
v = 0
flag = 0
i3 = pow(3,-1,n)

while pow(3,i) < n:
    t = pow(i3,i*e,n) * c % n
    io.sendline(str(t).encode())
    x = (read() - v) % 3
    v = ((v+x) * i3) % n
    flag += pow(3,i) * x
    i += 1

flag = long_to_bytes(flag)
flag = flag[flag.index(b'\0')+1:].decode()
success(flag)
